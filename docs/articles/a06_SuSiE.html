<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Coloc: using SuSiE to relax the single causal variant assumption • coloc</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Coloc: using SuSiE to relax the single causal variant assumption">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">coloc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">6.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/a01_intro.html">Coloc: a package for colocalisation analyses</a>
    </li>
    <li>
      <a href="../articles/a02_data.html">Coloc: data structures</a>
    </li>
    <li>
      <a href="../articles/a03_enumeration.html">Coloc: under a single causal variant assumption</a>
    </li>
    <li>
      <a href="../articles/a04_sensitivity.html">Coloc: sensitivity to prior values</a>
    </li>
    <li>
      <a href="../articles/a06_SuSiE.html">Coloc: using SuSiE to relax the single causal variant assumption</a>
    </li>
    <li>
      <a href="../articles/a07_variant-specific-priors.html">Coloc: using variant-specific priros in coloc</a>
    </li>
    <li>
      <a href="../articles/a05_conditioning.html">DEPRECATED Coloc: relaxing the single causal variant assumption</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/chr1swallace/coloc/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Coloc: using SuSiE to relax the single causal
variant assumption</h1>
                        <h4 data-toc-skip class="author">Chris
Wallace</h4>
            
            <h4 data-toc-skip class="date">2025-03-27</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/chr1swallace/coloc/blob/HEAD/vignettes/a06_SuSiE.Rmd" class="external-link"><code>vignettes/a06_SuSiE.Rmd</code></a></small>
      <div class="hidden name"><code>a06_SuSiE.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="multiple-causal-variants-using-susie-to-separate-the-signals">Multiple causal variants, using SuSiE to separate the signals<a class="anchor" aria-label="anchor" href="#multiple-causal-variants-using-susie-to-separate-the-signals"></a>
</h2>
<p>We load some simulated data.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/chr1swallace/coloc" class="external-link">coloc</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## This is coloc version 6.0.0</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">coloc_test_data</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/attach.html" class="external-link">attach</a></span><span class="op">(</span><span class="va">coloc_test_data</span><span class="op">)</span> <span class="co">## datasets D1, D2, D3 and D4</span></span></code></pre></div>
<p>Datasets 3 and 4 are constructed to deliberately break the single
causal variant assumption in <code><a href="../reference/coloc.abf.html">coloc.abf()</a></code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_dataset.html">plot_dataset</a></span><span class="op">(</span><span class="va">D3</span>, main<span class="op">=</span><span class="st">"Dataset D3"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_dataset.html">plot_dataset</a></span><span class="op">(</span><span class="va">D4</span>, main<span class="op">=</span><span class="st">"Dataset D4"</span><span class="op">)</span></span></code></pre></div>
<p><img src="a06_SuSiE_files/figure-html/sens0-1.png" width="768"></p>
<p>First, let us do a standard coloc (single causal variant) analysis to
serve as a baseline comparison. The analysis concludes there is
colocalisation, because it “sees” the SNPs on the left which are
strongly associated with both traits. But it misses the SNPs on the
right of the top left plot which are associated with only one trait.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my.res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/coloc.abf.html">coloc.abf</a></span><span class="op">(</span>dataset1<span class="op">=</span><span class="va">D3</span>, dataset2<span class="op">=</span><span class="va">D4</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## PP.H0.abf PP.H1.abf PP.H2.abf PP.H3.abf PP.H4.abf </span></span>
<span><span class="co">##  8.78e-26  6.80e-07  1.53e-22  1.85e-04  1.00e+00 </span></span>
<span><span class="co">## [1] "PP abf for shared variant: 100%"</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">my.res</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "coloc_abf" "list"</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## print.coloc_abf</span></span>
<span><span class="va">my.res</span></span></code></pre></div>
<pre><code><span><span class="co">## Coloc analysis of trait 1, trait 2</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## SNP Priors</span></span></code></pre>
<pre><code><span><span class="co">##    p1    p2   p12 </span></span>
<span><span class="co">## 1e-04 1e-04 1e-05</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Hypothesis Priors</span></span></code></pre>
<pre><code><span><span class="co">##        H0   H1   H2       H3    H4</span></span>
<span><span class="co">##  0.892505 0.05 0.05 0.002495 0.005</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Posterior</span></span></code></pre>
<pre><code><span><span class="co">##        nsnps           H0           H1           H2           H3           H4 </span></span>
<span><span class="co">## 5.000000e+02 8.775708e-26 6.797736e-07 1.529399e-22 1.848705e-04 9.998144e-01</span></span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sensitivity.html">sensitivity</a></span><span class="op">(</span><span class="va">my.res</span>,<span class="st">"H4 &gt; 0.9"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Results pass decision rule H4 &gt; 0.9</span></span></code></pre>
<p><img src="a06_SuSiE_files/figure-html/sens1-1.png" width="768"></p>
<p>Even though the sensitivity analysis itself looks good, the Manhattan
plots suggest we are violating the assumption of a single causal variant
per trait.</p>
<p>coloc has adopted the <a href="https://stephenslab.github.io/susie-paper/index.html" class="external-link">SuSiE</a>
framework for fine mapping in the presence of multiple causal variants.
This framework requires the LD matrix is known, so first check our
datasets hold an LD matrix of the right format. =check_dataset= should
return NULL if there are no problems, or print informative error
messages if there are.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/check_dataset.html">check_dataset</a></span><span class="op">(</span><span class="va">D3</span>,req<span class="op">=</span><span class="st">"LD"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## NULL</span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/check_dataset.html">check_dataset</a></span><span class="op">(</span><span class="va">D4</span>,req<span class="op">=</span><span class="st">"LD"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## NULL</span></span></code></pre>
<p>SuSiE can take a while to run on larger datasets, so it is best to
run once per dataset with the =runsusie= function, store the results and
feed those into subsequent analyses. =runsusie= is just a wrapper around
the =susie_rss= function in the <a href="https://stephenslab.github.io/susieR/" class="external-link">susieR package</a> that
automates running until convergence and saves a little extra information
about snp names to make subsequent coloc processing simpler. Here, it
does indeed find two signals for dataset D3 (there are two rows in the
credible sets summary) and one for dataset D4.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">S3</span><span class="op">=</span><span class="fu"><a href="../reference/runsusie.html">runsusie</a></span><span class="op">(</span><span class="va">D3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## running max iterations: 100</span></span></code></pre>
<pre><code><span><span class="co">##  converged: TRUE</span></span></code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">S3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Variables in credible sets:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  variable variable_prob cs</span></span>
<span><span class="co">##       105   0.777112364  1</span></span>
<span><span class="co">##        89   0.395106280  2</span></span>
<span><span class="co">##        87   0.271833777  2</span></span>
<span><span class="co">##        82   0.106275736  1</span></span>
<span><span class="co">##       103   0.080325924  1</span></span>
<span><span class="co">##        81   0.057211679  2</span></span>
<span><span class="co">##        80   0.051878567  2</span></span>
<span><span class="co">##        84   0.037874443  2</span></span>
<span><span class="co">##        68   0.036058478  2</span></span>
<span><span class="co">##        97   0.030410224  2</span></span>
<span><span class="co">##        75   0.018683900  2</span></span>
<span><span class="co">##       113   0.014731357  2</span></span>
<span><span class="co">##        69   0.011078296  2</span></span>
<span><span class="co">##        58   0.010512961  2</span></span>
<span><span class="co">##        73   0.008534130  2</span></span>
<span><span class="co">##       108   0.007895691  2</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Credible sets summary:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  cs cs_log10bf cs_avg_r2 cs_min_r2                                 variable</span></span>
<span><span class="co">##   1   8.626019 0.6743405 0.5947188                               82,103,105</span></span>
<span><span class="co">##   2   3.492207 0.6237635 0.4582396 58,68,69,73,75,80,81,84,87,89,97,108,113</span></span></code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">S4</span><span class="op">=</span><span class="fu"><a href="../reference/runsusie.html">runsusie</a></span><span class="op">(</span><span class="va">D4</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## running max iterations: 100</span></span>
<span><span class="co">##  converged: TRUE</span></span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">S4</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Variables in credible sets:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  variable variable_prob cs</span></span>
<span><span class="co">##       105     0.9051715  1</span></span>
<span><span class="co">##       156     0.0605820  1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Credible sets summary:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  cs cs_log10bf cs_avg_r2 cs_min_r2 variable</span></span>
<span><span class="co">##   1   4.940381 0.5047112 0.5047112  105,156</span></span></code></pre>
<p>With these susie output objects stored, we can colocalise every pair
of signals. This analysis says the first pair, tagged by s25.1 and s25
for datasets D3 and D4, do not colocalise (posterior for H3 is close to
1), whilst the second pair, tagged by the same SNP, s25, for both
datasets, do (posterior for H4 is close to 1).</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"susieR"</span>,quietly<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">susie.res</span><span class="op">=</span><span class="fu"><a href="../reference/coloc.susie.html">coloc.susie</a></span><span class="op">(</span><span class="va">S3</span>,<span class="va">S4</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">susie.res</span><span class="op">$</span><span class="va">summary</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<pre><code><span><span class="co">##    nsnps   hit1   hit2    PP.H0.abf    PP.H1.abf    PP.H2.abf    PP.H3.abf</span></span>
<span><span class="co">##    &lt;int&gt; &lt;char&gt; &lt;char&gt;        &lt;num&gt;        &lt;num&gt;        &lt;num&gt;        &lt;num&gt;</span></span>
<span><span class="co">## 1:   500   s105   s105 3.079008e-14 6.507291e-07 1.342030e-10 0.0008379729</span></span>
<span><span class="co">## 2:   500    s89   s105 1.422896e-06 2.209787e-04 6.201896e-03 0.9631063078</span></span>
<span><span class="co">##     PP.H4.abf  idx1  idx2</span></span>
<span><span class="co">##         &lt;num&gt; &lt;int&gt; &lt;int&gt;</span></span>
<span><span class="co">## 1: 0.99916138     1     1</span></span>
<span><span class="co">## 2: 0.03046939     2     1</span></span></code></pre>
<p>Note that because we are doing multiple colocalisations,
sensitivity() needs to know which to consider, and we need to give it
the datasets used if we want to see the Manhattan plots.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"susieR"</span>,quietly<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/sensitivity.html">sensitivity</a></span><span class="op">(</span><span class="va">susie.res</span>,<span class="st">"H4 &gt; 0.9"</span>,row<span class="op">=</span><span class="fl">1</span>,dataset1<span class="op">=</span><span class="va">D3</span>,dataset2<span class="op">=</span><span class="va">D4</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/sensitivity.html">sensitivity</a></span><span class="op">(</span><span class="va">susie.res</span>,<span class="st">"H4 &gt; 0.9"</span>,row<span class="op">=</span><span class="fl">2</span>,dataset1<span class="op">=</span><span class="va">D3</span>,dataset2<span class="op">=</span><span class="va">D4</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<pre><code><span><span class="co">## Results pass decision rule H4 &gt; 0.9</span></span></code></pre>
<p><img src="a06_SuSiE_files/figure-html/sens-1.png" width="768"></p>
<pre><code><span><span class="co">## Results fail decision rule H4 &gt; 0.9</span></span></code></pre>
<p><img src="a06_SuSiE_files/figure-html/sens-2.png" width="768"></p>
</div>
<div class="section level2">
<h2 id="important-notes-on-running-susie">Important notes on running SuSiE<a class="anchor" aria-label="anchor" href="#important-notes-on-running-susie"></a>
</h2>
<p><code><a href="../reference/runsusie.html">runsusie()</a></code> is a wrapper around
<code><a href="https://rdrr.io/pkg/susieR/man/susie_rss.html" class="external-link">susieR::susie_rss()</a></code>. It adds some colnames to the returned
objects (so that snps can be identified easily) and repeats the calls to
<code>susie_rss()</code> until convergence is achieved.</p>
<p><code>susie_rss()</code> has many other options and you should look
at them if <code><a href="../reference/runsusie.html">runsusie()</a></code> is not giving the output you expect.
They can be passed directly through <code><a href="../reference/runsusie.html">runsusie()</a></code>.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"susieR"</span>,quietly<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="op">?</span><span class="fu">susieR</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/susieR/man/susie_rss.html" class="external-link">susie_rss</a></span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>One option I have varied to help SuSiE detect weaker signals, is the
coverage parameter. By default <code>susie_rss</code> looks for signals
for which it can form a 95% credible set. By reducing the coverage, we
can find weaker signals. For example we find nothing in this weaker
signal dataset</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"susieR"</span>,quietly<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co">## make a dataset with a weaker signal</span></span>
<span>  <span class="va">D5</span><span class="op">=</span><span class="va">D3</span></span>
<span>  <span class="va">D5</span><span class="op">$</span><span class="va">varbeta</span><span class="op">=</span><span class="va">D5</span><span class="op">$</span><span class="va">varbeta</span> <span class="op">*</span> <span class="fl">4</span></span>
<span>  <span class="va">D5</span><span class="op">$</span><span class="va">N</span><span class="op">=</span><span class="va">D5</span><span class="op">$</span><span class="va">N</span> <span class="op">/</span> <span class="fl">2</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/plot_dataset.html">plot_dataset</a></span><span class="op">(</span><span class="va">D3</span>, main<span class="op">=</span><span class="st">"original D3"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/plot_dataset.html">plot_dataset</a></span><span class="op">(</span><span class="va">D5</span>, main<span class="op">=</span><span class="st">"weaker signal D5"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/runsusie.html">runsusie</a></span><span class="op">(</span><span class="va">D5</span><span class="op">)</span><span class="op">)</span> <span class="co"># default coverage 0.95</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>But by reducing the coverage we can find one signal</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"susieR"</span>,quietly<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/runsusie.html">runsusie</a></span><span class="op">(</span><span class="va">D5</span>,coverage<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span><span class="op">)</span>  <span class="co"># lower coverage</span></span>
<span><span class="op">}</span></span></code></pre></div>
<!-- And reducing it further finds the other as well -->
<!-- ``` r -->
<!-- if(requireNamespace("susieR",quietly=TRUE)) { -->
<!--   summary(runsusie(D5,coverage=0.001)) # even lower -->
<!-- } -->
<!-- ``` -->
<p>These values are just for illustration, I probably wouldn’t believe a
signal in a real dataset with a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>&gt;</mo><msup><mn>10</mn><mrow><mi>−</mi><mn>5</mn></mrow></msup></mrow><annotation encoding="application/x-tex">p &gt; 10^{-5}</annotation></semantics></math>.
They let you find weaker signals, but the signals they find may not be
real! coloc results should be treated with caution. Nonetheless, this
may be worthwhile if you have a dataset with a weak signal which you
know has replicated in independent data.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"susieR"</span>,quietly<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">S5</span><span class="op">=</span><span class="fu"><a href="../reference/runsusie.html">runsusie</a></span><span class="op">(</span><span class="va">D5</span>,coverage<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span>  <span class="co"># lower coverage</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">S5</span><span class="op">)</span></span>
<span>  <span class="va">res</span><span class="op">=</span><span class="fu"><a href="../reference/coloc.susie.html">coloc.susie</a></span><span class="op">(</span><span class="va">S5</span>,<span class="va">S4</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">summary</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Chris Wallace, Claudia Giambartolomei, Tom Willis, Jeffrey Pullin.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
